/* INTEGRAÇÃO DE PROCEDURES COM TABELAS */

/* APAGANDO TODAS AS MINHAS DATABASES P COMEÇAR MINHAS PROCEDURES DO ZERO */

DROP DATABASE COMERCIO$
DROP DATABASE EXERCICIO$
DROP DATABASE LIVRARIA$

DELIMITER $

CREATE DATABASE PROJETO$

USE PROJETO$

CREATE TABLE CURSOS(
	IDCURSO INT PRIMARY KEY AUTO_INCREMENT,
	NOME VARCHAR(30) NOT NULL,
	HORAS INT(3) NOT NULL,
	VALOR FLOAT(10,2) NOT NULL
);

INSERT INTO CURSOS VALUES(NULL, 'JAVA', 30, 40.00);
INSERT INTO CURSOS VALUES(NULL, 'BANCO DE DADOS', 40, 32.00);

SELECT * FROM CURSOS;

DELIMITER $


/* PROCEDURE PARA CADASTRAR DADOS */

CREATE PROCEDURE CAD_CURSO(P_NOME VARCHAR(30),
						   P_HORAS INT(3),
						   P_PRECO FLOAT(10,2))

BEGIN

	INSERT INTO CURSOS VALUES(NULL, P_NOME, P_HORAS, P_PRECO);

END$

DELIMITER ;

CALL CAD_CURSO('BI SQL SERVER', 35, 300.00);
CALL CAD_CURSO('POWER BI', 20, 100.00);
CALL CAD_CURSO('DATA SCIENCE', 60, 500.00);
CALL CAD_CURSO('PYTHON', 40, 50.00);
CALL CAD_CURSO('GITHUB', 15, 150.00);
CALL CAD_CURSO('ANALISE DE DADOS', 25, 130.00);
CALL CAD_CURSO('GRAFANA', 35, 50.00);

SELECT * FROM CURSOS;

/* CRIANDO UMA PROCEDURE QUE CONSULTA CURSOS */

DELIMITER $

CREATE PROCEDURE CONSULTA_CURSO()
BEGIN

	SELECT * FROM CURSOS;

END$

DELIMITER ;

CALL CONSULTA_CURSO();